---
title: "Analysis Pipeline: Dynamic Truncation"
output: html_document
  toc: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

## Models

### Naive

- Lognormal distribution (I think we should restrict to a single dist for clarity).

### Naive with censoring

- Basic censoring adjustment (i.e two day window for all delays).

### Right truncation adjusted

- Right truncation adjusted by normalising using the CMF of time from primary event to estimation time.

### Right truncation and censoring adjusted

- Right truncation adjusted by normalising using the CMF of time from primary event to estimation time.
- Censoring adjusted using uniform window

### Right truncation and censoring adjusted using latent process

- Latent variable approach assuming uniform prior.
- We can do this using `brms` or the direct stan approach. Potentially we should do both and compare in the SI as the `brms` one is likely good for less sophisticated practioners and the `stan` one is nice if people are more advanaced and looking to implement in their own models.

## Simulation

### Setup

- 3 distribution assumptions ("short", "medium", "long")
- Simulate an outbreak going from high growth to decay
- Estimate the distribution across snapshots of this outbreak

### Estimate distributions

- Estimate all models at chosen points across the outbreak (suggestion: "early outbreak", "near peak", "past peak", "late outbreak")

### Post-process for dynamic bias

- Post process all models using dynamic correction and known growth rate

### Summarise runtimes

- In addition to estimate quality we care about tractibility for the SI plot the runtimes of various methods.

## Case study

### Data

- Need some outbreak linelist data. The UKHSA paper may contain this.

### Estimate distributions

- Estimate distributions for similar points as in the simulation setting

### Estimate growth rate

- Estimate the growth rate retrospectively and comment on this. 

### Post-process for dynamic bias

- Apply growth rate correction to all estimates 

### Summarise runtimes

- Summarise runtimes