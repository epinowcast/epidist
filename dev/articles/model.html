<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Guide to the statistical models implemented in epidist • epidist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Guide to the statistical models implemented in epidist">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epidist</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.0.1000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/epidist.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ebola.html">Advanced features with Ebola data</a></li>
    <li><a class="dropdown-item" href="../articles/approx-inference.html">Approximate Bayesian inference</a></li>
    <li><a class="dropdown-item" href="../articles/model.html">Guide to the statistical models implemented in epidist</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/epidist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Guide to the statistical models implemented in epidist</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/epidist/blob/main/vignettes/model.Rmd" class="external-link"><code>vignettes/model.Rmd</code></a></small>
      <div class="d-none name"><code>model.Rmd</code></div>
    </div>

    
    
<p>The <code>epidist</code> package enables users to estimate delay distributions while accounting for common reporting biases.
This vignette first introduces the background <span class="citation">(<a href="#ref-park2024estimating">Park et al. 2024</a>)</span> required to understand the models implemented in <code>epidist</code>.
It then goes on to explain each model in turn.</p>
<div class="section level2" number="1">
<h2 id="maths">
<span class="header-section-number">1</span> Background<a class="anchor" aria-label="anchor" href="#maths"></a>
</h2>
<p>Estimating a delay distribution may appear to be simple: one could imagine fitting a probability distribution to a set of observed delays.
However, observed delays are often biased during an ongoing outbreak.
We begin by presenting a formalism for characterizing delay distributions as well as two main biases (truncation and censoring) affecting them.
We then present statistical models for correcting for these biases.</p>
<p>Any epidemiological delay requires a primary (starting) and a secondary (ending) event.
For example, the incubation period measures the time between infection (primary event) and symptom onset (secondary event).
Here, we use <span class="math inline">\(p\)</span> to denote the time of the primary event, and <span class="math inline">\(s\)</span> to denote the time of the secondary event.</p>
<div class="section level3" number="1.1">
<h3 id="forwards-and-backwards-distributions">
<span class="header-section-number">1.1</span> Forwards and backwards distributions<a class="anchor" aria-label="anchor" href="#forwards-and-backwards-distributions"></a>
</h3>
<p>We can measure any delay distribution in two different ways.
First, we can measure the forward distribution <span class="math inline">\(f_p(\tau)\)</span>, starting from a cohort of individuals who experienced the primary event at the same time <span class="math inline">\(p\)</span> and looking at when they experienced their secondary event.
Second, we can measure the backward distribution <span class="math inline">\(b_s(\tau)\)</span>, starting from a cohort of individuals who experienced the secondary event at the same time <span class="math inline">\(s\)</span> and looking at when they experienced their primary event.
While the length of each individual delay <span class="math inline">\(\tau = p-s\)</span> remains constant whether we look at it forward or backwards, the shape of the distribution is affected by the differences in perspectives due to the differences in cohort composition.</p>
<p>To illustrate their differences, let’s assume that primary and secondary events occur at rates, or equivalently incidences, <span class="math inline">\(\mathcal{P}(p)\)</span> and <span class="math inline">\(\mathcal{S}(s)\)</span>, respectively.
Then, the total density <span class="math inline">\(\mathcal{T}(p, s)\)</span> of individuals with a primary event at time <span class="math inline">\(p\)</span> and secondary event at time <span class="math inline">\(s\)</span> can be expressed equivalently in terms of both forward and backward distributions:
<span class="math display" id="eq:forwards-backwards">\[
\mathcal{T}(p, s) = \mathcal{P}(p) f_p(s - p)  = \mathcal{S}(s) b_s(s - p).  \tag{1.1}
\]</span>
Rearranging Equation <a href="#eq:forwards-backwards">(1.1)</a> gives
<span class="math display" id="eq:forwards-backwards2">\[
b_s(\tau) = \frac{\mathcal{P}(s - \tau) f_{s - \tau}(\tau)}{\mathcal{S}(s)}. \tag{1.2}
\]</span>
The denominator of Equation <a href="#eq:forwards-backwards2">(1.2)</a>, which corresponds to the incidence of secondary events, may be expressed as the integral over all possible delays
<span class="math display">\[
\mathcal{S}(s) = \int_{-\infty}^\infty \mathcal{P}(s - \tau) f_{s - \tau}(\tau) \text{d} \tau,
\]</span>
such that
<span class="math display">\[
b_s(\tau) = \frac{\mathcal{P}(s - \tau) f_{s - \tau}(\tau)}{\int_{-\infty}^\infty \mathcal{P}(s - \tau) f_{s - \tau}(\tau) \text{d} \tau}.
\]</span>
Here, we see that <span class="math inline">\(b_s(\tau)\)</span> depends not only on <span class="math inline">\(f_{s - \tau}(\tau)\)</span> but also on <span class="math inline">\(\mathcal{P}(s - \tau)\)</span>, meaning that past changes in the incidence pattern will affect the shape of the distribution.
Particularly, when an epidemic is growing, we are more likely to observe shorter delays, causing an underestimation of the mean delay.
Therefore, we always want to characterize epidemiological delays from the forward perspective and estimate the forward distribution.
For this reason, our current methodology focuses on biases that affect the estimation of the forward distribution.</p>
</div>
<div class="section level3" number="1.2">
<h3 id="right-truncation">
<span class="header-section-number">1.2</span> Right truncation<a class="anchor" aria-label="anchor" href="#right-truncation"></a>
</h3>
<p>One key bias that affects the forward distribution is right truncation.
Right truncation refers to the bias arising from the inability to observe future events and ocurs when we observe data based on the secondary events.
For example, assume the data are right truncated and we don’t observe secondary events past time <span class="math inline">\(T\)</span>.
Then, we will only observe delays whose secondary events occurred before time <span class="math inline">\(T\)</span>, causing us to underestimate the mean of the distribution as these delays will on average be shorter.</p>
<p>Bias from right truncation is greater when events are more likely to be more recent.
A common example of severely right truncated data is data collected during outbreaks when growth in incidence is exponential (so you are much more likely to have a recent event).
On the other hand, if data collection is continued until the end of an outbreak then many fewer events are likely to be more recent and so there will be little right truncation in general.</p>
<p>Mathematically right truncation can be described as follows.
Let <span class="math inline">\(P\)</span> and <span class="math inline">\(S\)</span> be random variables.
Let <span class="math inline">\(F_p\)</span> be the forward cumulative distribution.
Then, the probability of observing a delay of length <span class="math inline">\(\tau\)</span> given that the primary event occurred at time <span class="math inline">\(p\)</span> and a truncation at time <span class="math inline">\(T\)</span> can be written as:
<span class="math display" id="eq:right-truncation">\[
\begin{aligned}
\mathbb{P}(S = P + \tau \, | \, P = p, S &lt; T) &amp;= \frac{\mathbb{P}(S = P + \tau, P = p, S &lt; T)}{\mathbb{P}(P = p, S &lt; T)} \\
&amp;= \frac{\mathbb{P}(S = P + \tau &lt; T \, | \, P = p)\mathbb{P}(P = p)}{\mathbb{P}(S &lt; T \, | \, P = p)\mathbb{P}(P = p)} \\
&amp;= \frac{\mathbb{P}(S = P + \tau &lt; T \, | \, P = p)}{\mathbb{P}(S &lt; T \, | \, P = p)} \\
&amp;= \frac{f_p(\tau)}{\int_0^{T - p} f_p(x) \text{d}x} = \frac{f_p(\tau)}{F_p(T - p)}, \quad p + \tau &lt; T. \tag{1.3}
\end{aligned}
\]</span></p>
<p>Examining Equation <a href="#eq:right-truncation">(1.3)</a> illustrates that (right) truncation renormalises the density by the values which are possible.
For example, if the distribution <span class="math inline">\(x \sim \text{Unif}(0, 1)\)</span> were right truncated by <span class="math inline">\(T = 0.5\)</span> then <span class="math inline">\(x \sim \text{Unif}(0, 0.5)\)</span>.</p>
</div>
<div class="section level3" number="1.3">
<h3 id="interval-censoring">
<span class="header-section-number">1.3</span> Interval censoring<a class="anchor" aria-label="anchor" href="#interval-censoring"></a>
</h3>
<p>The exact timing of epidemiological events is often unknown.
Instead, we may only know that the event happened within a certain interval.
We refer to this as interval censoring.
A very common example of interval censoring in epidemiology is date censoring, where we only know, or are using, data to the day of an event rather than the precise time.
Other forms of interval censoring, like weekly or monthly interval censoring, are also common.
When both primary and secondary events are interval censored, this is referred to as double censoring.</p>
<p>Mathematically single interval censoring is defined as follows.
Assume the secondary event <span class="math inline">\(S\)</span> is censored and so we don’t know when the event exactly happened.
Instead, we only know that the secondary event happened between <span class="math inline">\(S_L\)</span> and <span class="math inline">\(S_R\)</span>.
Then,
<span class="math display">\[
\begin{aligned}
\mathbb{P}(S_L &lt; S &lt; S_R \, | \, P = p) &amp;= \int_{S_L}^{S_R} f_p(y-p) dy\\
&amp;= F_p(S_R-p) - F_p(S_L-p)
\end{aligned}
\]</span></p>
<p>Similarly, double interval censoring is defined as follows.
Now, assume that both the primary <span class="math inline">\(P\)</span> and secondary <span class="math inline">\(S\)</span> events are truncated.
We only know that the primary event happened between <span class="math inline">\(P_L\)</span> and <span class="math inline">\(P_R\)</span> and the secondary event happened between <span class="math inline">\(S_L\)</span> and <span class="math inline">\(S_R\)</span>.
We now write <span class="math inline">\(g_P\)</span> to denote the unconditional distribution of primary events.
Then,
<span class="math display">\[
\begin{aligned}
\mathbb{P}(S_L &lt; S &lt; S_R \, | \, P_L &lt; P &lt; P_R) &amp;= \mathbb{P}(P_L &lt; P &lt; P_R, S_L &lt; S &lt; S_R \, | \, P_L &lt; P &lt; P_R)\\
&amp;= \frac{\mathbb{P}(P_L &lt; P &lt; P_R, S_L &lt; S &lt; S_R)}{\mathbb{P}(P_L &lt; P &lt; P_R)}\\
&amp;= \frac{\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x) f_x(y-x) \,dy\, dx}{\int_{P_L}^{P_R} g_P(z)\, dz  }\\
&amp;= \int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x\,|\,P_L,P_R) f_x(y-x) \,dy\, dx
\end{aligned}
\]</span>
where $ g_P(x,|,P_L,P_R)$ represents the conditional distribution of primary event given lower <span class="math inline">\(P_L\)</span> and upper <span class="math inline">\(P_R\)</span> bounds.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="the-naive-model">
<span class="header-section-number">2</span> The naive model<a class="anchor" aria-label="anchor" href="#the-naive-model"></a>
</h2>
<p>The simplest approach to modelling epidemiological delay distributions is ignoring truncation and censoring biases and simply treating the delays as continuous fully observed data.
Then, the likelihood of observing a delay <span class="math inline">\(\mathbf{Y}_i\)</span> given parameter <span class="math inline">\(\boldsymbol{\theta}\)</span> is straightforward:
<span class="math display">\[
\mathcal{L}(\mathbf{Y}_i \, | \, \boldsymbol{\theta}) = f(y_i - x_i).
\]</span>
where <span class="math inline">\(y_i\)</span> and <span class="math inline">\(x_i\)</span> are the observed primary and secondary event times.</p>
<p>As shown in <span class="citation">(<a href="#ref-park2024estimating">Park et al. 2024</a>)</span> when the data is double censored this modelling approach biases the mean by approximately a day as well as the standard deviation.
Where right truncation is also present biases can be more severe with plausible simulated scenarios leading to biased means that were &gt;30% shorter than the true distributions.</p>
</div>
<div class="section level2" number="3">
<h2 id="the-latent-model">
<span class="header-section-number">3</span> The latent model<a class="anchor" aria-label="anchor" href="#the-latent-model"></a>
</h2>
<p>This approach aims to account for the right truncation and double censoring using a generative modelling approach.
For each event, a latent variable is used to represent the exact time of the event.
This then allows the modelling of the continuous distribution, adjusted for the right truncation.
Whilst this is an approximation <span class="citation">(<a href="#ref-park2024estimating">Park et al. 2024</a>)</span> showed good recovery of simulated distributions in a range of settings.
However, the use of two latent variables per observed delay means that this approach may scale poorly with larger datasets.
That being said this approach has been used successfully in multiple real-world outbreak settings (<span class="citation">(<a href="#ref-ward2022transmission"><strong>ward2022transmission?</strong></a>)</span>).</p>
<p>Mathematically this model is described as follows.
We look at the conditional probability that the secondary event <span class="math inline">\(S\)</span> falls between <span class="math inline">\(S_L\)</span> and <span class="math inline">\(S_R\)</span>, given that the primary event <span class="math inline">\(P\)</span> falls between <span class="math inline">\(P_L\)</span> and <span class="math inline">\(P_R\)</span> and that the secondary event <span class="math inline">\(S\)</span> occurs before the truncation time <span class="math inline">\(T\)</span>:
<span class="math display">\[
\begin{aligned}
\mathbb{P}(S_L &lt; S &lt; S_R \, | \, P_L &lt; P &lt; P_R, S&lt;T) &amp;= \mathbb{P}(P_L &lt; P &lt; P_R, S_L &lt; S &lt; S_R, S&lt;T \, | \, P_L &lt; P &lt; P_R, S&lt;T)\\
&amp;= \frac{\mathbb{P}(P_L &lt; P &lt; P_R, S_L &lt; S &lt; S_R, S&lt;T)}{\mathbb{P}(P_L &lt; P &lt; P_R, S&lt;T)}\\
&amp;= \frac{\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x) f_x(y-x) \,dy\, dx}{\int_{P_L}^{P_R} \int_{z}^T g_P(z) f_z(w-z) \, dz \,dw  }\\
&amp;= \frac{\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x) f_x(y-x) \,dy\, dx}{\int_{P_L}^{P_R} g_P(z) F_z(T-z) \,dw  }\\
&amp;= \frac{\int_{P_L}^{P_R} \int_{S_L}^{S_R} g_P(x|P_L, P_R) f_x(y-x) \,dy\, dx}{\int_{P_L}^{P_R} g_P(z|P_L, P_R) F_z(T-z) \,dw  }\\
\end{aligned}
\]</span>
Using latent variables, we can now rewrite the observation likelihood as:
<span class="math display">\[
\begin{aligned}
x_i &amp;\sim g_P(x_i \, | \, p_{L, i}, p_{R, i}) \\
y_i &amp;\sim \text{Unif}(s_{L, i}, s_{R, i}) \\
\mathcal{L}(\mathbf{Y} \, | \, \boldsymbol{\theta}) &amp;= \prod_i \left[ \frac{f_{x_i}(y_i - x_i)}{\int_{P_{L, i}}^{P_{R, i}} g_P(z \, | \, p_{L, i}, p_{R, i}) F_z(T - z) \text{d}z} \right].
\end{aligned}
\]</span>
As before, <span class="math inline">\(g_P(z \, | \, p_{L, i}, p_{R, i})\)</span> represents the conditional distribution of the primary event given lower <span class="math inline">\(P_L\)</span> and upper <span class="math inline">\(P_R\)</span> bounds; this is equivalent to modelling the incidence in primary events.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-park2024estimating" class="csl-entry">
Park, Sang Woo, Andrei R. Akhmetzhanov, Kelly Charniga, Anne Cori, Nicholas G. Davies, Jonathan Dushoff, Sebastian Funk, et al. 2024. <span>“Estimating Epidemiological Delay Distributions for Infectious Diseases.”</span> <em>medRxiv</em>. <a href="https://doi.org/10.1101/2024.01.12.24301247" class="external-link">https://doi.org/10.1101/2024.01.12.24301247</a>.
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://athowes.github.io/" class="external-link">Adam Howes</a>, Sang Woo Park, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
