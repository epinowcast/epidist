<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>The marginal model method for epidist_linelist_data objects — as_epidist_marginal_model.epidist_linelist_data • epidist</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="The marginal model method for epidist_linelist_data objects — as_epidist_marginal_model.epidist_linelist_data"><meta name="description" content="This method converts linelist data to a marginal model format by calculating
delays between primary and secondary events, along with observation times and
censoring windows. The likelihood used is imported from the
primarycensored package
which handles censoring in both primary and secondary events as well as
truncation due to observation times. In principle, this method should be
more accurate and more computationally efficient than the latent model
(as_epidist_latent_model()) approach in most settings except when the
number of unique strata approaches the number of observations."><meta property="og:description" content="This method converts linelist data to a marginal model format by calculating
delays between primary and secondary events, along with observation times and
censoring windows. The likelihood used is imported from the
primarycensored package
which handles censoring in both primary and secondary events as well as
truncation due to observation times. In principle, this method should be
more accurate and more computationally efficient than the latent model
(as_epidist_latent_model()) approach in most settings except when the
number of unique strata approaches the number of observations."><meta property="og:image" content="https://epidist.epinowcast.org/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epidist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epidist.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/faq.html">FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ebola.html">Advanced features with Ebola data</a></li>
    <li><a class="dropdown-item" href="../articles/approx-inference.html">Approximate Bayesian inference</a></li>
    <li><a class="dropdown-item" href="../articles/model.html">Guide to the statistical models implemented in epidist</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epinowcast/epidist/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>The marginal model method for <code>epidist_linelist_data</code> objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/epinowcast/epidist/blob/main/R/marginal_model.R" class="external-link"><code>R/marginal_model.R</code></a></small>
      <div class="d-none name"><code>as_epidist_marginal_model.epidist_linelist_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This method converts linelist data to a marginal model format by calculating
delays between primary and secondary events, along with observation times and
censoring windows. The likelihood used is imported from the
<a href="https://primarycensored.epinowcast.org/" class="external-link">primarycensored</a> package
which handles censoring in both primary and secondary events as well as
truncation due to observation times. In principle, this method should be
more accurate and more computationally efficient than the latent model
(<code><a href="as_epidist_latent_model.html">as_epidist_latent_model()</a></code>) approach in most settings except when the
number of unique strata approaches the number of observations.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'epidist_linelist_data'</span></span>
<span><span class="fu"><a href="as_epidist_marginal_model.html">as_epidist_marginal_model</a></span><span class="op">(</span><span class="va">data</span>, obs_time_threshold <span class="op">=</span> <span class="fl">2</span>, weight <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>An <code>epidist_linelist_data</code> object</p></dd>


<dt id="arg-obs-time-threshold">obs_time_threshold<a class="anchor" aria-label="anchor" href="#arg-obs-time-threshold"></a></dt>
<dd><p>Ratio used to determine threshold for setting
relative observation times to Inf. Observation times greater than
<code>obs_time_threshold</code> times the maximum delay will be set to Inf to improve
model efficiency by reducing the number of unique observation times.
Default is 2.</p></dd>


<dt id="arg-weight">weight<a class="anchor" aria-label="anchor" href="#arg-weight"></a></dt>
<dd><p>A column name to use for weighting the data in the
likelihood. Default is NULL. Internally this is used to define the 'n'
column of the returned object.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used in this method.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When a formula is specified in <code><a href="epidist.html">epidist()</a></code>, the data will be transformed
using <code><a href="epidist_transform_data_model.epidist_marginal_model.html">epidist_transform_data_model.epidist_marginal_model()</a></code> to prepare it
for model fitting. This transformation summarises the data by counting unique
combinations of delays, observation times, censoring windows and any
variables in the model formula.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other marginal_model:
<code><a href="as_epidist_marginal_model.html">as_epidist_marginal_model</a>()</code>,
<code><a href="as_epidist_marginal_model.epidist_aggregate_data.html">as_epidist_marginal_model.epidist_aggregate_data</a>()</code>,
<code><a href="epidist_family_model.epidist_marginal_model.html">epidist_family_model.epidist_marginal_model</a>()</code>,
<code><a href="epidist_formula_model.epidist_marginal_model.html">epidist_formula_model.epidist_marginal_model</a>()</code>,
<code><a href="epidist_transform_data_model.epidist_marginal_model.html">epidist_transform_data_model.epidist_marginal_model</a>()</code>,
<code><a href="is_epidist_marginal_model.html">is_epidist_marginal_model</a>()</code>,
<code><a href="new_epidist_marginal_model.html">new_epidist_marginal_model</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sierra_leone_ebola_data</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_epidist_linelist_data.html">as_epidist_linelist_data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    pdate_lwr <span class="op">=</span> <span class="st">"date_of_symptom_onset"</span>,</span></span>
<span class="r-in"><span>    sdate_lwr <span class="op">=</span> <span class="st">"date_of_sample_tested"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="as_epidist_marginal_model.html">as_epidist_marginal_model</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No primary event upper bound provided, using the primary event lower bound + 1 day as the assumed upper bound.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No secondary event upper bound provided, using the secondary event lower bound + 1 day as the assumed upper bound.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> No observation time column provided, using 2015-09-14 as the observation date (the maximum of the secondary event upper bound).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> Setting 8294 observation times beyond 98 (=2x max delay) to Inf. This</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   improves model efficiency by reducing unique observation times while</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   maintaining model accuracy as these times should have negligible impact.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 8,358 × 22</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ptime_lwr ptime_upr stime_lwr stime_upr obs_time    id   age sex   pdate_lwr </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span>         0         1         5         6      484     1    20 Fema… 2014-05-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span>         2         3         7         8      484     2    42 Fema… 2014-05-20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span>         2         3         7         8      484     3    45 Fema… 2014-05-20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span>         3         4         8         9      484     4    15 Fema… 2014-05-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span>         3         4         8         9      484     5    19 Fema… 2014-05-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span>         3         4         8         9      484     6    55 Fema… 2014-05-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span>         3         4         8         9      484     7    50 Fema… 2014-05-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span>         4         5         9        10      484     8     8 Fema… 2014-05-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span>         4         5         9        10      484     9    54 Fema… 2014-05-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span>         4         5         9        10      484    10    57 Fema… 2014-05-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 8,348 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 13 more variables: sdate_lwr &lt;date&gt;, district &lt;chr&gt;, chiefdom &lt;chr&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   pdate_upr &lt;date&gt;, sdate_upr &lt;date&gt;, obs_date &lt;date&gt;, pwindow &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   swindow &lt;dbl&gt;, relative_obs_time &lt;dbl&gt;, orig_relative_obs_time &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   delay_lwr &lt;dbl&gt;, delay_upr &lt;dbl&gt;, n &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://athowes.github.io/" class="external-link">Adam Howes</a>, Sang Woo Park, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

